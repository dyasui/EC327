---
title: Activity 6 Results
format:
  html:
    code-fold: true
    code-summary: "See the code"
---

On homework 3, I ask you use some statistics about the class data from activity 6 to relate
to theoretical predictions.
I realised not everyone has taken a stats or metrics class yet, 
so I wanted to post some pieces of `R` code as examples of starting places to help you answer this question.

Feel free to use as much (or to ignore) of the code provided as you want,
but keep in mind that just copying these statistics without applying them to specific theoretical 
predictions will not be enough to earn you credit for this assignment.

Click on any heading with `> See the code` to reveal hidden code chunks:
```{r}
# comments look like this
print("This is R code")
```

## Dataset Structure

I collected the results from the in-class penalty kicks activity as a csv file
where each row represents an different attempted shot.

The columns `round`, `match`, and `shot` contain the id representing which 
round in the bracket, which match of that specific round, 
and whether that shot was the first, second, third, fourth, or fifth shot of that match,
respectively.

To make these data easier to visualize and calculate statistics, 
you can import them to an object in `R` using the `read_csv` function
from the `tidyverse` package.

```{r}
#| code-fold: false
#| message: false
#| warning: false
# load tidyverse packages
library(tidyverse)

# setwd("activities/06PenaltyKicks")

# read in the class results from csv file
data <- read_csv("EC327F25-activity6_results.csv") 

# print the first 10 observations
head(data, n = 10)
```

The important variables are the choices of the kicker and goalie
for each kick attempt as well as whether a goal was scored or not: 

  * `kick` represents the direction the kicker chose to kick
  * `dive` represents the direction the goalie chose to attempt to block
  * `goal` is an indicator which is `TRUE` if a goal was scored,
  and `FALSE` if a kick was blocked or missed.

```{r}
#| code-fold: false
N <- nrow(data)
```

Across all rounds and matches played in class this quarter,
we had `r N` different shots attempted, which are each a row in this dataset.

## Strategy Frequencies

```{r}
data |> 
group_by(kick) |> 
summarise(
  n = n(),
  p = n / N,
  goals = sum(goal),
  avg_goal = mean(goal)
) |> 
ggplot(aes(x="", fill=kick, y=p)) +
geom_bar(stat = "identity", width=1, color="white") +
coord_polar("y",start=0) +
theme_void() +
# geom_text(aes(label = s_k), position = position_stack(vjust = 0.5)) +
geom_text(aes(label = p), position = position_stack(vjust = 0.5))
```

```{r}
data |> 
group_by(dive) |> 
summarise(
  n = n(),
  p = n / N,
  goals = sum(goal),
  avg_goal = mean(goal)
) |> 
ggplot(aes(x="", fill=dive, y=p)) +
geom_bar(stat = "identity", width=1, color="white") +
coord_polar("y",start=0) +
theme_void() +
# geom_text(aes(label = s_k), position = position_stack(vjust = 0.5)) +
geom_text(aes(label = p), position = position_stack(vjust = 0.5))
```
## Success Rates by Strategy

### Kickers' win rates by strategy
```{r}
#| message: false
data |>
  group_by(kick) |>
  summarise(
    n = n(),
    goals = sum(goal),
    win_rate = goals / n
  )
```

### Goalies' win rates by strategy
```{r}
#| message: false
data |>
  group_by(dive) |>
  summarise(
    n = n(),
    goals = sum(goal),
    win_rate = goals / n
  )
```

### Testing strategy profiles against theory

Think about how you could compare the theory of mixed-strategy Nash equilibrium
against the data generated from class.

What are some hypotheses you could generate using the theory
to compare to statistics from the activity?