{
  "hash": "ee194bbda41ba77ddc02fe8c470883f2",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: Activity 6 Results\nformat:\n  html:\n    code-fold: true\n    code-summary: \"See the code\"\n---\n\nOn homework 3, I ask you use some statistics about the class data from activity 6 to relate\nto theoretical predictions.\nI realised not everyone has taken a stats or metrics class yet, \nso I wanted to post some pieces of `R` code as examples of starting places to help you answer this question.\n\nFeel free to use as much (or to ignore) of the code provided as you want,\nbut keep in mind that just copying these statistics without applying them to specific theoretical \npredictions will not be enough to earn you credit for this assignment.\n\nClick on any heading with `> See the code` to reveal hidden code chunks:\n\n::: {.cell}\n\n```{.r .cell-code}\n# comments look like this\nprint(\"This is R code\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"This is R code\"\n```\n\n\n:::\n:::\n\n\n## Dataset Structure\n\nI collected the results from the in-class penalty kicks activity as a csv file\nwhere each row represents an different attempted shot.\n\nThe columns `round`, `match`, and `shot` contain the id representing which \nround in the bracket, which match of that specific round, \nand whether that shot was the first, second, third, fourth, or fifth shot of that match,\nrespectively.\n\nTo make these data easier to visualize and calculate statistics, \nyou can import them to an object in `R` using the `read_csv` function\nfrom the `tidyverse` package.\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"false\"}\n# load tidyverse packages\nlibrary(tidyverse)\n\n# setwd(\"activities/06PenaltyKicks\")\n\n# read in the class results from csv file\ndata <- read_csv(\"EC327F25-activity6_results.csv\") %>%\n  filter(!is.na(s_k), !is.na(s_g)) # filter out missing data\n\n# print the first 10 observations\nhead(data, n = 10)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 10 × 8\n   round match player    shot   s_k    s_g    goal  final_score\n   <dbl> <dbl> <chr>     <chr>  <chr>  <chr>  <lgl>       <dbl>\n 1     1     1 Owen      shot 1 Left   Left   TRUE            3\n 2     1     1 Alejandro shot 1 Left   Left   FALSE           2\n 3     1     1 Owen      shot 2 Right  Right  FALSE           3\n 4     1     1 Alejandro shot 2 Center Left   FALSE           2\n 5     1     1 Owen      shot 3 Left   Left   FALSE           3\n 6     1     1 Alejandro shot 3 Left   Center TRUE            2\n 7     1     1 Owen      shot 4 Left   Center TRUE            3\n 8     1     1 Alejandro shot 4 Left   Right  TRUE            2\n 9     1     1 Owen      shot 5 Right  Center FALSE           3\n10     1     1 Alejandro shot 5 Right  Right  FALSE           2\n```\n\n\n:::\n:::\n\n\nThe important variables are the choices of the kicker and goalie\nfor each kick attempt as well as whether a goal was scored or not: \n\n  * `s_k` represents the direction the kicker chose to kick\n  * `s_g` represents the direction the goalie chose to attempt to block\n  * `goal` is an indicator which is `TRUE` if a goal was scored,\n  and `FALSE` if a kick was blocked or missed.\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"false\"}\nN <- nrow(data)\n```\n:::\n\n\nAcross all rounds and matches played in class this quarter,\nwe had 320 different shots attempted, which are each a row in this dataset.\n\n## Group Results by Srategy Profile\n\nI might want to compare how often we see a kicker choosing $Right$\nat the same time a goalie blocked $Right$,\nvs a kicker chosing $Right$ when a goalie blocked $Left$, etc, \nfor all 9 different possible pure strategy combinations.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# summarize by type of strategy profile\nprofiles_tbl <- data %>%\n  group_by(s_k, s_g) %>% # group by each strategy combo to summarise each group\n  summarise(\n    n = n(), # get counts of each profile\n    p = n / N, # calculate proportions of total observations\n    num_goals = sum(goal), # count numbers of goals scored\n    prob_goal = num_goals / N # probability of goal scored\n  ) %>%\n  ungroup() # get rid of groups structure to make later manipulations easier\n# print the profiles table\nprofiles_tbl\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 9 × 6\n  s_k    s_g        n      p num_goals prob_goal\n  <chr>  <chr>  <int>  <dbl>     <int>     <dbl>\n1 Center Center    26 0.0812         0    0     \n2 Center Left      21 0.0656        13    0.0406\n3 Center Right     27 0.0844        21    0.0656\n4 Left   Center    44 0.138         37    0.116 \n5 Left   Left      45 0.141         17    0.0531\n6 Left   Right     41 0.128         33    0.103 \n7 Right  Center    29 0.0906        24    0.075 \n8 Right  Left      42 0.131         34    0.106 \n9 Right  Right     45 0.141         14    0.0438\n```\n\n\n:::\n:::\n\n\nThis table shows that the Kicker choosing $Left$ when the goalie chose $Right$\nwas the most common type of outcome, which happened in 14% of the 320 total shots.\n\n### Plotting frequency of each strategy profile\nIf you want a more visual representation of the information in this table,\nyou could use a bar graph where each bar represents a row of the table:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(profiles_tbl, aes(x = s_g, y = n, fill = s_k)) +\n  geom_bar(stat = \"identity\") +\n  facet_wrap(vars(s_k))\n```\n\n::: {.cell-output-display}\n![](penaltykicks_results_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\n### Testing strategy profiles against theory\n\nIf you wanted to compare the frequency of each type of choice matchup in this table \nwith what you would expect in an MSNE, you could use the `chisq.test` function\nto test the goodness of fit of the `n` column in our table to some\ntheoretical distribution of `p` which we would expect for each pure strategy combination.\n\nFor example, suppose that a mixed strategy Nash equilibrium of this game \nwould result in each profile being observed with equal probability of 1/9.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# use observed num of each choice combo from profiles table\nn_observed <- profiles_tbl %>% select(n)\n# theoretical predictions of each profile being observed\n# make sure they're in the same order as in the profiles table\np_predicted <- c(1/9, 1/9, 1/9, 1/9, 1/9, 1/9, 1/9, 1/9, 1/9)\n# test whether n is drawn from p_predicted distribution\nchisq.test(\n  x = n_observed,\n  p = p_predicted\n)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tChi-squared test for given probabilities\n\ndata:  n_observed\nX-squared = 20.819, df = 8, p-value = 0.007645\n```\n\n\n:::\n:::\n\n\nCompare the resulting $\\chi^2$- statistic against the critical value of\n15.51\nfrom the $\\chi^2$ distribution with 8 degrees of freedom at the 95% confidence level.\n\n## Comparing Kicker's Strategies\n\nInstead of comparing to a specific distribution of observed strategy combinations,\nyou might be interested in seeing the actual average payoff to either player \nfor each of their strategies played in the data.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# summarise win probabiltiy by kicker's strategy\nkicker_strats <- data %>%\n  group_by(s_k) %>% # group all kickers strategies together\n  summarise(\n    num_goals = sum(goal), # count how many times kicker scored\n    prob_goal = sum(goal) / N # calculate success rate\n  )\n# print kicker strategies table\nkicker_strats\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 3 × 3\n  s_k    num_goals prob_goal\n  <chr>      <int>     <dbl>\n1 Center        34     0.106\n2 Left          87     0.272\n3 Right         72     0.225\n```\n\n\n:::\n:::\n\n\n### Testing for equal success rates for each kick\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# use observed num of each choice combo from kicker strategies table\nn_observed <- kicker_strats %>% select(num_goals)\n# equal probobility of success for each strategy\np_predicted <- c(1/3, 1/3, 1/3)\n# test whether num_goals are equal across strategy choice\nchisq.test(\n  x = n_observed,\n  p = p_predicted\n)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tChi-squared test for given probabilities\n\ndata:  n_observed\nX-squared = 23.202, df = 2, p-value = 9.157e-06\n```\n\n\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# chi-square critical value with 2 degrees of freedom\nchisq.crit <- qchisq(p = 0.95, df = 2)\n```\n:::\n\n\nCompare $\\chi^2$-statistic to a critical value of 5.99.\nIf the statistic is greater than the critical value, \nreject the null hypothesis that the success rates are equal with 95% confidence.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata %>%\n  mutate(\n    s_k = case_when(\n      s_k %in% c(\"Right\", \"Left\") ~ \"Side\",\n      s_k == \"Center\" ~ \"Center\"\n    ),\n    s_g = case_when(\n      s_g %in% c(\"Right\", \"Left\") ~ \"Side\",\n      s_g == \"Center\" ~ \"Center\"\n    )\n  ) %>%\n  group_by(s_k, s_g) %>%\n  summarise(\n    n_obs = n(),\n    num_goals = sum(goal==TRUE),\n    prob_goal = sum(goal) / n()\n  )\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n`summarise()` has grouped output by 's_k'. You can override using the `.groups`\nargument.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 4 × 5\n# Groups:   s_k [2]\n  s_k    s_g    n_obs num_goals prob_goal\n  <chr>  <chr>  <int>     <int>     <dbl>\n1 Center Center    26         0     0    \n2 Center Side      48        34     0.708\n3 Side   Center    73        61     0.836\n4 Side   Side     173        98     0.566\n```\n\n\n:::\n:::\n\n",
    "supporting": [
      "penaltykicks_results_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}